<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ARISE SYSTEM</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{
margin:0;
font-family:Segoe UI;
background:#000;
color:#0ff;
text-align:center;
}
.card{
background:#061018;
margin:15px;
padding:20px;
border-radius:15px;
box-shadow:0 0 15px cyan;
}
.quest{
margin:10px;
padding:15px;
border-radius:12px;
background:#020d12;
box-shadow:0 0 10px #0ff3;
}
.done{background:#013220;color:#0f0}
button{
margin:4px;
padding:6px 12px;
border:none;
border-radius:8px;
background:#0ff;
font-weight:bold;
cursor:pointer;
}
.timer{color:#fff;font-size:14px}
</style>
</head>
<body>

<h1>ARISE SYSTEM</h1>

<div class="card">
LEVEL <span id="level"></span><br>
XP <span id="xp"></span>/100<br>
Rank <span id="rank"></span><br>
Streak <span id="streak"></span>
</div>

<div class="card">
STR <span id="str"></span> |
INT <span id="int"></span> |
FOC <span id="foc"></span>
</div>

<button onclick="enableNoti()">Enable Reminders</button>

<div class="card">
<h2>Daily Quests</h2>
<div id="quests"></div>
</div>

<audio id="beep" src="beep.mp3"></audio>

<script>
const today=new Date().toDateString();

let data=JSON.parse(localStorage.getItem("arise"))||{
date:today,
xp:0,
level:1,
str:1,
int:1,
foc:1,
streak:0,
quests:{},
missed:0
};

function save(){localStorage.setItem("arise",JSON.stringify(data))}

function rank(l){
if(l<5)return"E";
if(l<15)return"D";
if(l<30)return"C";
if(l<45)return"B";
if(l<60)return"A";
if(l<100)return"S";
return"SS";
}

/* ---------- DAILY RESET ---------- */
if(data.date!==today){

let missed=0;
for(let q in data.quests)
if(!data.quests[q].done) missed++;

data.missed=missed;
data.date=today;
data.streak++;
generateQuests();
}

/* ---------- QUEST GENERATOR ---------- */
function generateQuests(){

data.quests={
"Exercise":{time:1200,stat:"str"},
"Deep Thinking":{time:1800,stat:"foc"},
"Learn Skill":{time:3600,stat:"int"},
"Strategy Thinking":{time:2400,stat:"int"},
"Problem Solving":{time:1800,stat:"foc"}
};

/* penalty quests next day */
if(data.missed>0){
for(let i=0;i<data.missed;i++){
data.quests["Penalty "+(i+1)]={time:1500,stat:"str"};
}
}

/* surprise quests every 5 levels */
if(data.level%5===0){
data.quests["SURPRISE QUEST"={time:900,stat:"int"};
}

for(let q in data.quests){
data.quests[q].remaining=data.quests[q].time;
data.quests[q].running=false;
data.quests[q].done=false;
}

save();
}

if(Object.keys(data.quests).length===0) generateQuests();

/* ---------- TIMER LOOP ---------- */
setInterval(()=>{

for(let q in data.quests){
let quest=data.quests[q];

if(quest.running && quest.remaining>0){
quest.remaining--;

/* reminders */
if(quest.remaining===60) notify("1 minute left",q);
if(quest.remaining%600===0) notify("Stay focused",q);

/* finished */
if(quest.remaining<=0){
quest.running=false;
notify("Quest Finished",q);
}
}
}
render();
save();

},1000);

/* ---------- CONTROLS ---------- */
function start(q){
let quest=data.quests[q];
if(!quest.done){
quest.running=true;
notify("Started",q);
}
}

function pause(q){
data.quests[q].running=false;
}

function done(q){

let quest=data.quests[q];

if(quest.remaining>0){
alert("Time not finished");
return;
}

if(!quest.done){
quest.done=true;
data.xp+=25;
data[quest.stat]++;
if(data.xp>=100){
data.level++;
data.xp=0;
notify("LEVEL UP","You reached level "+data.level);
}
}
}

/* ---------- NOTIFICATIONS ---------- */
async function enableNoti(){
await Notification.requestPermission();
}

function notify(title,text){
if(Notification.permission==="granted"){
new Notification(title,{body:text});
document.getElementById("beep").play().catch(()=>{});
}
}

/* ---------- RENDER ---------- */
function render(){

level.textContent=data.level;
xp.textContent=data.xp;
rank.textContent=rank(data.level);
streak.textContent=data.streak;
str.textContent=data.str;
int.textContent=data.int;
foc.textContent=data.foc;

let html="";
for(let q in data.quests){

let quest=data.quests[q];
let m=Math.floor(quest.remaining/60);
let s=quest.remaining%60;

html+=`
<div class="quest ${quest.done?"done":""}">
<b>${q}</b><br>
<span class="timer">${m}m ${s}s</span><br>

<button onclick="start('${q}')">Start</button>
<button onclick="pause('${q}')">Pause</button>
<button onclick="done('${q}')">Done</button>
</div>
`;
}

quests.innerHTML=html;
}

render();
</script>
</body>
</html>
