<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ARISE SYSTEM</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  background:#0b0f1a;
  color:#00eaff;
  font-family:'Orbitron',sans-serif;
  text-align:center;
}

h1{margin-top:10px}

.panel{
  border:1px solid #00eaff;
  margin:15px;
  padding:15px;
  border-radius:10px;
  box-shadow:0 0 15px #00eaff55;
}

.quest{
  border:1px solid #00eaff55;
  padding:10px;
  margin:10px;
  border-radius:8px;
}

.penalty{border-color:red;color:#ff6b6b}

button{
  background:black;
  color:#00eaff;
  border:1px solid #00eaff;
  padding:6px 10px;
  margin:4px;
  cursor:pointer;
}

button:disabled{
  opacity:.4;
  cursor:not-allowed;
}

#levelup{
  position:fixed;
  top:40%;
  width:100%;
  font-size:40px;
  color:#00eaff;
  display:none;
  animation:pop 1s ease;
}

@keyframes pop{
  0%{transform:scale(.3);opacity:0}
  50%{transform:scale(1.3)}
  100%{transform:scale(1);opacity:1}
}
</style>
</head>
<body>

<h1>⚔ ARISE SYSTEM</h1>

<div class="panel">
Level: <span id="lvl"></span> |
XP: <span id="xp"></span> |
Rank: <span id="rank"></span> |
Streak: <span id="streak"></span>
</div>

<div class="panel">
STR <span id="str"></span> |
INT <span id="int"></span> |
FOC <span id="foc"></span>
</div>

<div class="panel">
<button onclick="enableNotif()">Enable Notifications</button>
</div>

<div class="panel">
<h2>Daily Quests</h2>
<div id="dailyBox"></div>
</div>

<div class="panel">
<h2>Penalty Quests</h2>
<div id="penaltyBox"></div>
</div>

<div class="panel">
<h2>Special Quests</h2>
<div id="specialBox"></div>
</div>

<div id="levelup">LEVEL UP</div>

<audio id="beep" src="beep.mp3"></audio>

<script>
/* ================= DATA ================= */

const daily={
"Exercise":{time:1200,xp:20,stat:"str"},
"Deep Thinking":{time:1800,xp:25,stat:"foc"},
"Learn Skill":{time:3600,xp:40,stat:"int"},
"Strategy Thinking":{time:2400,xp:30,stat:"int"},
"Problem Solving":{time:1800,xp:25,stat:"foc"}
};

const specials={
30:"Read business strategy book",
40:"Solve 5 logic puzzles",
60:"Build small project",
80:"Design business plan"
};

/* ================= SAVE ================= */

const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
const load=(k,d)=>JSON.parse(localStorage.getItem(k))??d;

/* ================= PLAYER ================= */

let xp=load("xp",0);
let lvl=load("lvl",1);
let str=load("str",0);
let int=load("int",0);
let foc=load("foc",0);
let streak=load("streak",0);

const today=new Date().toDateString();
let last=load("last","");

/* ========== DAILY RESET ========== */

if(last!==today){

let done=load("done",{});
let missed={};

for(let q in daily)
if(!done[q]) missed[q]=true;

save("missed",missed);
save("done",{});
save("last",today);

if(Object.keys(missed).length===0) streak++;
else streak=0;

save("streak",streak);
}

/* ================= RANK ================= */

function rank(){
if(lvl>=100)return"S+";
if(lvl>=75)return"A";
if(lvl>=50)return"B";
if(lvl>=35)return"C";
if(lvl>=10)return"D";
return"E";
}

/* ================= UI UPDATE ================= */

function update(){
lvlEl.textContent=lvl;
xpEl.textContent=xp;
rankEl.textContent=rank();
strEl.textContent=str;
intEl.textContent=int;
focEl.textContent=foc;
streakEl.textContent=streak;
}

const lvlEl=document.getElementById("lvl");
const xpEl=document.getElementById("xp");
const rankEl=document.getElementById("rank");
const strEl=document.getElementById("str");
const intEl=document.getElementById("int");
const focEl=document.getElementById("foc");
const streakEl=document.getElementById("streak");

/* ================= XP ================= */

function addXP(n){
xp+=n;
if(xp>=100){
xp-=100;
lvl++;
levelAnim();
}
save("xp",xp);
save("lvl",lvl);
update();
}

function addStat(s,n){
if(s==="str"){str+=n;save("str",str);}
if(s==="int"){int+=n;save("int",int);}
if(s==="foc"){foc+=n;save("foc",foc);}
update();
}

function levelAnim(){
const el=document.getElementById("levelup");
el.style.display="block";
setTimeout(()=>el.style.display="none",1200);
}

/* ================= TIMER ================= */

function timer(name,time,xpGain,stat,isPenalty){

let rem=time;

const t=document.getElementById("t-"+name);
const start=document.getElementById("s-"+name);
const pause=document.getElementById("p-"+name);
const done=document.getElementById("d-"+name);

start.disabled=true;
pause.disabled=false;

let inter=setInterval(run,1000);

function run(){
rem--;

let m=Math.floor(rem/60);
let s=rem%60;
t.textContent=`${m}:${s<10?"0":""}${s}`;

if(rem<=0){
clearInterval(inter);
pause.disabled=true;
done.disabled=false;
notify(name+" finished");
beep.play().catch(()=>{});
}
}

pause.onclick=()=>{
clearInterval(inter);
start.disabled=false;
pause.disabled=true;
};

start.onclick=()=>{
timer(name,rem,xpGain,stat,isPenalty);
};

done.onclick=()=>{
if(rem>0)return alert("Finish timer first");

addXP(xpGain);
addStat(stat,5);

let doneList=load("done",{});
doneList[name]=true;
save("done",doneList);

if(isPenalty){
let m=load("missed",{});
delete m[name];
save("missed",m);
renderPenalty();
}

done.disabled=true;
};
}

/* ================= RENDER DAILY ================= */

function renderDaily(){
dailyBox.innerHTML="";
let done=load("done",{});

for(let q in daily){

const d=daily[q];

const div=document.createElement("div");
div.className="quest";

div.innerHTML=`
<h3>${q}</h3>
<p id="t-${q}">${Math.floor(d.time/60)}:00</p>
<button id="s-${q}">Start</button>
<button id="p-${q}" disabled>Pause</button>
<button id="d-${q}" disabled>Done</button>
`;

dailyBox.appendChild(div);

document.getElementById("s-"+q).onclick=
()=>timer(q,d.time,d.xp,d.stat,false);

if(done[q]){
div.style.opacity=.4;
div.querySelectorAll("button").forEach(b=>b.disabled=true);
}
}
}

/* ================= PENALTY ================= */

function renderPenalty(){
penaltyBox.innerHTML="";
let missed=load("missed",{});

for(let q in missed){

const d=daily[q];

const div=document.createElement("div");
div.className="quest penalty";

div.innerHTML=`
<h3>Penalty: ${q}</h3>
<p id="t-${q}">${Math.floor(d.time/60)}:00</p>
<button id="s-${q}">Start</button>
<button id="p-${q}" disabled>Pause</button>
<button id="d-${q}" disabled>Done</button>
`;

penaltyBox.appendChild(div);

document.getElementById("s-"+q).onclick=
()=>timer(q,d.time,Math.floor(d.xp/2),d.stat,true);
}
}

/* ================= SPECIAL ================= */

function renderSpecial(){
specialBox.innerHTML="";
if(specials[lvl]){
const div=document.createElement("div");
div.className="quest";
div.innerHTML=`⭐ ${specials[lvl]}`;
specialBox.appendChild(div);
notify("Special Quest Unlocked!");
}
}

/* ================= NOTIFY ================= */

function enableNotif(){
Notification.requestPermission();
}

function notify(msg){
if(Notification.permission==="granted"){
new Notification("ARISE",{body:msg});
}
}

/* ================= START ================= */

renderDaily();
renderPenalty();
renderSpecial();
update();
</script>
</body>
</html>
